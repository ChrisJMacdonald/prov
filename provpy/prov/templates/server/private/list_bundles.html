{# Copyright (C) 2011 University of Southampton #}
{% extends "base.html" %}
{% load url from future %}
{% load server_tags %}
{% block title %}PROVServer Bundles{% endblock %}
{% block content %}
	{% if user.is_authenticated %}
	<h1>Welcome {{ user.username }}, this is your Provenance Repository!</h1>
	<p>You can browse all available bundles here.</p>
	<a class="btn btn-primary pull-right" onClick="go_to('{% url 'server.views.create_bundle' %}');">Add New</a>
	{% endif %}
	<table class="table">  
        <thead>  
          <tr>
          	<th style="widht: 14%">Role</th>
            <th style="width: 50%">Bundle-ID</th>  
            <th style="width: 12%"></th>
            <th style="width: 12%"></th>
            <th style="width: 12%"></th>   
          </tr>  
        </thead>  
        <tbody>
         {% for vars in bundles %}  
          <tr>   
          	<td>{% status_label vars.2 %}</td>
            <td>{{ vars.1 }}</td>  
            <td><a class="btn btn-info" type="button" href="{% url 'server.views.bundle_detail' vars.0 %}">View</a></td>  
            <td><a class="btn btn-info" type="button" href="{% url 'server.views.bundle_svg' vars.0 %}">SVG</a></td>
            <td>{% if vars.2 == 'o' or vars.2 == 'a' %}
            <a class="btn btn-success" type="button" href="{% url 'server.views.admin_bundle' vars.0 %}">Admin</a></td>
            {% endif %}
            {% if vars.2 == 'o' or vars.2 == 'a' or vars.2 == 'd' %} 
            <form action="{% url 'server.views.list_bundles' %}" method="post" >
            	{% csrf_token %}
            	<td><button class="btn btn-danger" type="submit" value="Delete">Delete</button></td>
            	<input type="hidden" name="delete_id" value="{{ vars.0 }}" />
            </form>
            {% else %}<td></td>{% endif %}
          </tr>  
        {% endfor %}
        </tbody>  
      </table>
      {% if user.is_authenticated and bundles|length > 10 %}
	  <input class="btn btn-primary offset10" type="button" onClick="go_to('{% url 'server.views.create_bundle' %}')" value="Add New" />  
	  {% endif %}
{% endblock %}
