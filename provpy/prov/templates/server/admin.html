{# Copyright (C) 2011 University of Southampton #}
{% extends "base.html" %}
{% load url from future %}
{% load guardian_tags %}
{% block content %}
<script type="text/javascript">
jQuery(function($) {
  $('div.btn-group[data-toggle-name=*]').each(function(){
    var group   = $(this);
    var form    = group.parents('form').eq(0);
    var name    = group.attr('data-toggle-name');
    var hidden  = $('input[name="' + name + '"]', form);
    $('button', group).each(function(){
      var button = $(this);
      button.live('click', function(){
          hidden.val($(this).val());
      });
      if(button.val() == hidden.val()) {
        button.addClass('active');
      }
    });
  });
});
</script>	
      	<div class="span3">
        	<h2>Bundle {{ bundle.rec_id }}</h2>
        	</br>
        	<h4>Currently the bundle is {% if public %}Public.{% else %}Private.{% endif %}</h4>
        	<form class="form-inline" action="{% url 'server.views.admin_bundle' bundle.id %}" method="post">
         	{% csrf_token %}
         	<button type="submit" value="submit" class="btn btn-info">
          	Make {% if public %}Private{% else %}Public{% endif %}</button>  
         	<input type="hidden" name="name" value="public" />
         	<input type="hidden" name="type" value="group" />  
         	<input type="hidden" name="role" value="{% if public %}none{% else %}Reader{% endif %}" />
         	</form>
        </div>
        <span class="span4">
        <form class="form-horizontal" action="{% url 'server.views.admin_bundle' bundle.id %}" method="post">
         	{% csrf_token %}
         	<div class="control-group">  
            	<label class="control-label">Name</label>  
            	<div class="controls">  
              		<input type="text" class="input-xlarge" name="name">
					<div class="btn-group" data-toggle-name="type" data-toggle="buttons-radio" >
					  <button type="button" value="user" class="btn" data-toggle="button">User</button>
					  <button type="button" value="group" class="btn" data-toggle="button">Group</button>
					</div>
					<input type="hidden" name="type" value="user" />
					<select name="role" style="width:120px">
					    <option>Administrator</option>   
		                <option>Operator</option>   
		                <option>Contributor</option>  
		                <option>Reader</option>   
                 	</select>
                	<button type="submit" value="submit" class="btn btn-primary">Add</button>
                	{% if message %}
					<h3>{{ message }}</h3>
					{% endif %}  	
          		</div>
          	</div>      
          </form>
      </span>
      <span class="span4">
      <a class="btn btn-primary pull-right" onClick="go_to('/prov/home');">Back</a>
      </span>
<span class="span11">
      <table class="table">  
        <thead>  
          <tr><th><h3>Owner</h3></th></tr>  
        </thead>  
        <tbody>  
          <tr><td>{{ bundle.owner }}</td></tr>  
        </tbody>  
      </table>
{% include 'server/perm_table.html' with op1='Administrator' op2='Operator' op3='Contributor' op4='Reader' p_number=4 %}
{% include 'server/perm_table.html' with op1='Operator' op2='Administrator' op3='Contributor' op4='Reader' p_number=3 %}
{% include 'server/perm_table.html' with op1='Contributor' op2='Administrator' op3='Operator' op4='Reader' p_number=2 %}
{% include 'server/perm_table.html' with op1='Reader' op2='Administrator' op3='Operator' op4='Contributor' p_number=1 %}
</span>
{% endblock %}
